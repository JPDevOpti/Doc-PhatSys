# EstadÃ­sticas de Casos

El submÃ³dulo de estadÃ­sticas proporciona anÃ¡lisis completos y reportes detallados sobre el rendimiento del sistema PathSys, incluyendo mÃ©tricas de casos, patÃ³logos, entidades y oportunidad de atenciÃ³n.

## VisiÃ³n General

Este submÃ³dulo maneja mÃºltiples dimensiones de anÃ¡lisis:

- **Dashboard General**: MÃ©tricas principales y resÃºmenes ejecutivos
- **EstadÃ­sticas por Entidad**: Rendimiento y anÃ¡lisis por EPS/entidades
- **AnÃ¡lisis de Oportunidad**: Tiempos de respuesta y cumplimiento de SLA
- **Rendimiento de PatÃ³logos**: Productividad y calidad por especialista
- **EstadÃ­sticas por Pruebas**: AnÃ¡lisis de tipos de exÃ¡menes y frecuencias

## Estructura del SubmÃ³dulo

```
statistics/
â”œâ”€â”€ routes/
â”‚   â”œâ”€â”€ dashboard_statistics_routes.py      # Dashboard principal
â”‚   â”œâ”€â”€ entity_statistics_routes.py         # EstadÃ­sticas por entidad
â”‚   â”œâ”€â”€ opportunity_statistics_routes.py    # AnÃ¡lisis de oportunidad
â”‚   â”œâ”€â”€ pathologist_statistics_routes.py    # Rendimiento de patÃ³logos
â”‚   â”œâ”€â”€ test_statistics_routes.py          # EstadÃ­sticas por pruebas
â”‚   â””â”€â”€ statistics_router.py               # Router principal
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ dashboard_statistics_service.py     # LÃ³gica de dashboard
â”‚   â”œâ”€â”€ entity_statistics_service.py        # LÃ³gica por entidad
â”‚   â”œâ”€â”€ opportunity_statistics_service.py   # LÃ³gica de oportunidad
â”‚   â”œâ”€â”€ pathologist_statistics_service.py   # LÃ³gica de patÃ³logos
â”‚   â””â”€â”€ test_statistics_service.py         # LÃ³gica por pruebas
â”œâ”€â”€ repositories/
â”‚   â”œâ”€â”€ dashboard_statistics_repository.py  # Acceso a datos dashboard
â”‚   â”œâ”€â”€ entity_statistics_repository.py     # Acceso a datos entidades
â”‚   â”œâ”€â”€ opportunity_statistics_repository.py # Acceso a datos oportunidad
â”‚   â”œâ”€â”€ pathologist_statistics_repository.py # Acceso a datos patÃ³logos
â”‚   â””â”€â”€ test_statistics_repository.py      # Acceso a datos pruebas
â””â”€â”€ schemas/
    â”œâ”€â”€ dashboard_statistics_schemas.py     # Esquemas dashboard
    â”œâ”€â”€ entity_statistics_schemas.py        # Esquemas entidades
    â”œâ”€â”€ opportunity_statistics_schemas.py   # Esquemas oportunidad
    â”œâ”€â”€ pathologist_statistics_schemas.py   # Esquemas patÃ³logos
    â””â”€â”€ test_statistics_schemas.py         # Esquemas pruebas
```

## Componentes Principales

### ğŸ“Š **Dashboard General**
MÃ©tricas principales del sistema con resÃºmenes ejecutivos, casos por mes, mÃ©tricas generales y validaciones de patÃ³logos.

**Endpoints principales:**
- `GET /statistics/dashboard/cases-by-month/{year}` - Casos por mes
- `GET /statistics/dashboard/overview` - Resumen general
- `GET /statistics/metrics/general` - MÃ©tricas principales

### ğŸ¥ **EstadÃ­sticas por Entidad**
AnÃ¡lisis detallado del rendimiento por EPS y entidades de salud.

**Endpoints principales:**
- `GET /statistics/entities/monthly-performance` - Rendimiento mensual
- `GET /statistics/entities/details` - Detalles por entidad
- `GET /statistics/entities/pathologists` - PatÃ³logos por entidad

### â±ï¸ **AnÃ¡lisis de Oportunidad**
MÃ©tricas de tiempos de respuesta y cumplimiento de SLA.

**Endpoints principales:**
- `GET /statistics/opportunity/monthly` - Oportunidad mensual
- `GET /statistics/opportunity/details` - Detalles de oportunidad
- `GET /statistics/opportunity/trends` - Tendencias temporales

### ğŸ‘¨â€âš•ï¸ **Rendimiento de PatÃ³logos**
AnÃ¡lisis de productividad y calidad por especialista.

**Endpoints principales:**
- `GET /statistics/pathologists/performance` - Rendimiento individual
- `GET /statistics/pathologists/comparison` - ComparaciÃ³n entre patÃ³logos
- `GET /statistics/pathologists/workload` - Carga de trabajo

### ğŸ§ª **EstadÃ­sticas por Pruebas**
AnÃ¡lisis de tipos de exÃ¡menes, frecuencias y tendencias.

**Endpoints principales:**
- `GET /statistics/tests/frequency` - Frecuencia por tipo
- `GET /statistics/tests/trends` - Tendencias temporales
- `GET /statistics/tests/performance` - Rendimiento por prueba

## CaracterÃ­sticas Principales

### Agregaciones Temporales
- **Mensual**: AnÃ¡lisis por mes especÃ­fico
- **Anual**: Comparaciones anuales
- **Trimestral**: Tendencias trimestrales
- **Semanal**: AnÃ¡lisis de corto plazo

### Filtros Avanzados
- **Por Entidad**: EPS especÃ­ficas
- **Por PatÃ³logo**: Especialista individual
- **Por Tipo de Prueba**: Examen especÃ­fico
- **Por Estado**: Casos en diferentes etapas
- **Por Prioridad**: Normal vs Prioritario

### MÃ©tricas Calculadas
- **Volumen**: Cantidad de casos procesados
- **Oportunidad**: Tiempos de respuesta promedio
- **Calidad**: Tasas de error y retrabajos
- **Productividad**: Casos por patÃ³logo
- **Cumplimiento**: Adherencia a SLA

## Tipos de Respuesta

### MÃ©tricas BÃ¡sicas
```json
{
  "total_cases": 1250,
  "completed_cases": 1180,
  "pending_cases": 70,
  "average_processing_time": 3.2,
  "period": "2025-01"
}
```

### Datos Temporales
```json
{
  "year": 2025,
  "monthly_data": [120, 135, 142, 158, 167, 145, 139, 152, 148, 156, 162, 171],
  "total_year": 1795
}
```

### AnÃ¡lisis Comparativo
```json
{
  "entities": [
    {
      "name": "EPS Salud Total",
      "cases": 450,
      "avg_time": 2.8,
      "compliance": 95.2
    },
    {
      "name": "Nueva EPS",
      "cases": 380,
      "avg_time": 3.1,
      "compliance": 92.1
    }
  ]
}
```

## NavegaciÃ³n del SubmÃ³dulo

Explora cada componente para documentaciÃ³n detallada:

- [Dashboard General](./dashboard) - MÃ©tricas principales y resÃºmenes
- [EstadÃ­sticas por Entidad](./entidades) - AnÃ¡lisis por EPS
- [AnÃ¡lisis de Oportunidad](./oportunidad) - Tiempos y SLA
- [Rendimiento de PatÃ³logos](./patologos) - Productividad especialistas
- [EstadÃ­sticas por Pruebas](./pruebas) - AnÃ¡lisis de exÃ¡menes

## ConfiguraciÃ³n y OptimizaciÃ³n

### Variables de Entorno
```bash
# ConfiguraciÃ³n de estadÃ­sticas
STATS_CACHE_TTL=3600  # Cache TTL en segundos
STATS_MAX_MONTHS=24   # MÃ¡ximo meses a consultar
ENABLE_STATS_CACHE=true

# ConfiguraciÃ³n de agregaciones
STATS_BATCH_SIZE=1000
STATS_PARALLEL_QUERIES=5
STATS_TIMEOUT=30
```

### Optimizaciones de Base de Datos
- Ãndices especÃ­ficos para consultas estadÃ­sticas
- Agregaciones pre-calculadas para mÃ©tricas frecuentes
- Cache de resultados para consultas repetitivas
- Particionamiento temporal de datos histÃ³ricos

### Consideraciones de Rendimiento
- Consultas asÃ­ncronas para mÃºltiples mÃ©tricas
- PaginaciÃ³n para grandes volÃºmenes de datos
- CompresiÃ³n de respuestas JSON
- Cache distribuido para resultados frecuentes