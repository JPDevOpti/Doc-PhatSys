---
id: import-administrators
title: Import Administrators
sidebar_position: 1
---

# Script de Importaci√≥n de Administradores

El script `import_administrators.py` es responsable de crear usuarios administradores del sistema PathSys con credenciales predefinidas. Este script es fundamental para la inicializaci√≥n del sistema, ya que establece los usuarios con privilegios administrativos necesarios para la gesti√≥n de la plataforma.

## Objetivo

Crear usuarios administradores del sistema con roles y permisos completos para la gesti√≥n de PathSys, incluyendo la configuraci√≥n inicial y administraci√≥n de otros usuarios.

## Ubicaci√≥n del Archivo

```
Back-End/Scripts/import_administrators.py
```

## Funcionalidad Principal

### Creaci√≥n de Administradores
El script crea usuarios administradores con la siguiente informaci√≥n:

- **Datos personales**: Nombre completo, email, identificaci√≥n
- **Credenciales**: Contrase√±as predefinidas (deben cambiarse en producci√≥n)
- **Roles**: Permisos administrativos completos
- **Estado**: Usuarios activos por defecto

### Administradores Predefinidos

El script incluye los siguientes administradores:

```python
administrators = [
    {
        "name": "Administrator",
        "email": "admin@pathsys.com",
        "identification": "1000000001",
        "password": "admin123"  # Cambiar en producci√≥n
    },
    {
        "name": "System Admin",
        "email": "system@pathsys.com", 
        "identification": "1000000002",
        "password": "system123"  # Cambiar en producci√≥n
    },
    {
        "name": "Super User",
        "email": "super@pathsys.com",
        "identification": "1000000003", 
        "password": "super123"  # Cambiar en producci√≥n
    }
]
```

## Dependencias y Servicios

### Servicios Utilizados
- **`UserManagementService`**: Servicio principal para gesti√≥n de usuarios
- **`get_user_management_service()`**: Factory para obtener instancia del servicio

### Esquemas de Datos
- **`AdministratorCreate`**: Schema Pydantic para validaci√≥n de datos de administradores

### Importaciones Principales
```python
from app.modules.users.services.user_management_service import get_user_management_service
from app.modules.users.schemas.administrator import AdministratorCreate
```

## Estructura del Script

### 1. Configuraci√≥n Inicial
```python
import asyncio
from typing import List
import logging

# Setup logging
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)
```

### 2. Definici√≥n de Datos
```python
# Predefined administrator data
ADMINISTRATORS_DATA = [
    {
        "name": "Administrator",
        "email": "admin@pathsys.com",
        "identification": "1000000001",
        "password": "admin123"
    },
    # ... more administrators
]
```

### 3. Funci√≥n Principal
```python
async def import_administrators():
    """Import predefined administrators into the system"""
    service = get_user_management_service()
    
    for admin_data in ADMINISTRATORS_DATA:
        try:
            # Create administrator schema
            admin_create = AdministratorCreate(**admin_data)
            
            # Check if administrator already exists
            existing = await service.get_user_by_email(admin_data["email"])
            if existing:
                logger.info(f"Administrator {admin_data['email']} already exists")
                continue
            
            # Create new administrator
            result = await service.create_administrator(admin_create)
            logger.info(f"Created administrator: {result.email}")
            
        except Exception as e:
            logger.error(f"Error creating administrator {admin_data['email']}: {e}")
```

## Caracter√≠sticas T√©cnicas

### üîí Validaciones
- **Email √∫nico**: Verificaci√≥n de emails no duplicados
- **Identificaci√≥n √∫nica**: Control de n√∫meros de identificaci√≥n
- **Formato de datos**: Validaci√≥n mediante schemas Pydantic
- **Existencia previa**: Verificaci√≥n antes de crear

### üõ°Ô∏è Seguridad
- **Contrase√±as hasheadas**: Almacenamiento seguro de contrase√±as
- **Validaci√≥n de entrada**: Sanitizaci√≥n de datos de entrada
- **Manejo de errores**: Control robusto de excepciones
- **Logging seguro**: Registro sin exponer credenciales

### ‚ö° Rendimiento
- **Operaciones as√≠ncronas**: Procesamiento no bloqueante
- **Verificaci√≥n previa**: Evita duplicados innecesarios
- **Transacciones at√≥micas**: Consistencia de datos
- **Logging eficiente**: Registro optimizado de operaciones

## Uso del Script

### Ejecuci√≥n B√°sica
```bash
# Desde el directorio ra√≠z del proyecto
python3 Scripts/import_administrators.py
```

### Ejecuci√≥n con Logging Detallado
```bash
# Con nivel de logging DEBUG
PYTHONPATH=. python3 Scripts/import_administrators.py --verbose
```

### Verificaci√≥n de Resultados
```bash
# Verificar administradores creados
python3 -c "
from app.modules.users.services.user_management_service import get_user_management_service
import asyncio

async def check_admins():
    service = get_user_management_service()
    admins = await service.list_administrators()
    print(f'Total administrators: {len(admins)}')
    for admin in admins:
        print(f'- {admin.name} ({admin.email})')

asyncio.run(check_admins())
"
```

## Casos de Uso

### 1. Inicializaci√≥n del Sistema
```python
# Primera configuraci√≥n del sistema
await import_administrators()
print("Sistema inicializado con administradores")
```

### 2. Restauraci√≥n de Administradores
```python
# Despu√©s de reset de base de datos
await import_administrators()
print("Administradores restaurados")
```

### 3. Adici√≥n de Nuevos Administradores
```python
# Modificar ADMINISTRATORS_DATA y ejecutar
new_admin = {
    "name": "New Admin",
    "email": "newadmin@pathsys.com",
    "identification": "1000000004",
    "password": "newadmin123"
}
ADMINISTRATORS_DATA.append(new_admin)
```

## Consideraciones Importantes

### Seguridad en Producci√≥n
- **Cambiar contrase√±as**: Las contrase√±as predefinidas DEBEN cambiarse
- **Emails corporativos**: Usar emails del dominio de la organizaci√≥n
- **Identificaciones reales**: Usar n√∫meros de identificaci√≥n v√°lidos
- **Acceso restringido**: Limitar qui√©n puede ejecutar este script

### Configuraci√≥n Recomendada
- **Variables de entorno**: Usar para contrase√±as en producci√≥n
- **Archivo de configuraci√≥n**: Externalizar datos de administradores
- **Validaci√≥n adicional**: Implementar reglas de negocio espec√≠ficas
- **Auditor√≠a**: Registrar creaci√≥n de administradores

### Requisitos Previos
- Base de datos MongoDB configurada y accesible
- Servicios de usuarios inicializados
- Dependencias de Python instaladas
- Variables de entorno configuradas

### Limitaciones
- Contrase√±as en texto plano en el c√≥digo (solo para desarrollo)
- Datos hardcodeados (considerar externalizar)
- Sin validaci√≥n de pol√≠ticas de contrase√±as complejas
- Sin notificaci√≥n autom√°tica a administradores creados

## Integraci√≥n con Otros M√≥dulos

### M√≥dulo de Usuarios
- Utiliza `UserManagementService` para operaciones CRUD
- Implementa schemas de validaci√≥n de usuarios
- Integra con sistema de autenticaci√≥n y autorizaci√≥n

### M√≥dulo de Autenticaci√≥n
- Los administradores creados pueden autenticarse inmediatamente
- Roles y permisos se asignan autom√°ticamente
- Integraci√≥n con JWT y sesiones

### M√≥dulo de Auditor√≠a
- Registra la creaci√≥n de administradores
- Mantiene historial de cambios
- Facilita trazabilidad de operaciones administrativas

Este script es esencial para el funcionamiento inicial de PathSys, proporcionando los usuarios administrativos necesarios para la gesti√≥n completa del sistema.